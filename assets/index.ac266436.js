(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))p(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const w of c.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&p(w)}).observe(document,{childList:!0,subtree:!0});function e(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function p(s){if(s.ep)return;s.ep=!0;const c=e(s);fetch(s.href,c)}})();var Oe=(()=>{var g=import.meta.url;return function(e){e=e||{};var e=typeof e<"u"?e:{},p,s;e.ready=new Promise(function(n,t){p=n,s=t});var c=Object.assign({},e),w=typeof window=="object",h=typeof importScripts=="function",M=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",_="";function oe(n){return e.locateFile?e.locateFile(n,_):_+n}var k,P,I;if(M){h?_=require("path").dirname(_)+"/":_=__dirname+"/";var F,G,H=()=>{G||(F=require("fs"),G=require("path"))};k=(n,t)=>(H(),n=G.normalize(n),F.readFileSync(n,t?void 0:"utf8")),I=n=>{var t=k(n,!0);return t.buffer||(t=new Uint8Array(t)),t},P=(n,t,r)=>{H(),n=G.normalize(n),F.readFile(n,function(o,l){o?r(o):t(l.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(n){if(!(n instanceof Ee))throw n}),process.on("unhandledRejection",function(n){throw n}),e.inspect=function(){return"[Emscripten Module object]"}}else(w||h)&&(h?_=self.location.href:typeof document<"u"&&document.currentScript&&(_=document.currentScript.src),g&&(_=g),_.indexOf("blob:")!==0?_=_.substr(0,_.replace(/[?#].*/,"").lastIndexOf("/")+1):_="",k=n=>{var t=new XMLHttpRequest;return t.open("GET",n,!1),t.send(null),t.responseText},h&&(I=n=>{var t=new XMLHttpRequest;return t.open("GET",n,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),P=(n,t,r)=>{var o=new XMLHttpRequest;o.open("GET",n,!0),o.responseType="arraybuffer",o.onload=()=>{if(o.status==200||o.status==0&&o.response){t(o.response);return}r()},o.onerror=r,o.send(null)});e.print||console.log.bind(console);var T=e.printErr||console.warn.bind(console);Object.assign(e,c),c=null,e.arguments&&e.arguments,e.thisProgram&&e.thisProgram,e.quit&&e.quit;var S;e.wasmBinary&&(S=e.wasmBinary),e.noExitRuntime,typeof WebAssembly!="object"&&O("no native wasm support detected");var W,j=!1,z=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ce(n,t,r){for(var o=t+r,l=t;n[l]&&!(l>=o);)++l;if(l-t>16&&n.buffer&&z)return z.decode(n.subarray(t,l));for(var u="";t<l;){var i=n[t++];if(!(i&128)){u+=String.fromCharCode(i);continue}var a=n[t++]&63;if((i&224)==192){u+=String.fromCharCode((i&31)<<6|a);continue}var y=n[t++]&63;if((i&240)==224?i=(i&15)<<12|a<<6|y:i=(i&7)<<18|a<<12|y<<6|n[t++]&63,i<65536)u+=String.fromCharCode(i);else{var A=i-65536;u+=String.fromCharCode(55296|A>>10,56320|A&1023)}}return u}function ue(n,t){return n?ce(D,n,t):""}function fe(n,t,r,o){if(!(o>0))return 0;for(var l=r,u=r+o-1,i=0;i<n.length;++i){var a=n.charCodeAt(i);if(a>=55296&&a<=57343){var y=n.charCodeAt(++i);a=65536+((a&1023)<<10)|y&1023}if(a<=127){if(r>=u)break;t[r++]=a}else if(a<=2047){if(r+1>=u)break;t[r++]=192|a>>6,t[r++]=128|a&63}else if(a<=65535){if(r+2>=u)break;t[r++]=224|a>>12,t[r++]=128|a>>6&63,t[r++]=128|a&63}else{if(r+3>=u)break;t[r++]=240|a>>18,t[r++]=128|a>>12&63,t[r++]=128|a>>6&63,t[r++]=128|a&63}}return t[r]=0,r-l}function de(n,t,r){return fe(n,D,t,r)}var q,D;function le(n){e.HEAP8=q=new Int8Array(n),e.HEAP16=new Int16Array(n),e.HEAP32=new Int32Array(n),e.HEAPU8=D=new Uint8Array(n),e.HEAPU16=new Uint16Array(n),e.HEAPU32=new Uint32Array(n),e.HEAPF32=new Float32Array(n),e.HEAPF64=new Float64Array(n)}e.INITIAL_MEMORY;var V=[],K=[],Y=[];function me(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)ge(e.preRun.shift());L(V)}function pe(){L(K)}function _e(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)ve(e.postRun.shift());L(Y)}function ge(n){V.unshift(n)}function ye(n){K.unshift(n)}function ve(n){Y.unshift(n)}var b=0,U=null;function Re(n){b++,e.monitorRunDependencies&&e.monitorRunDependencies(b)}function we(n){if(b--,e.monitorRunDependencies&&e.monitorRunDependencies(b),b==0&&U){var t=U;U=null,t()}}function O(n){e.onAbort&&e.onAbort(n),n="Aborted("+n+")",T(n),j=!0,n+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(n);throw s(t),t}var he="data:application/octet-stream;base64,";function $(n){return n.startsWith(he)}function J(n){return n.startsWith("file://")}var d;e.locateFile?(d="dds.wasm",$(d)||(d=oe(d))):d=new URL("/dds.wasm",self.location).toString();function Q(n){try{if(n==d&&S)return new Uint8Array(S);if(I)return I(n);throw"both async and sync fetching of the wasm failed"}catch(t){O(t)}}function be(){if(!S&&(w||h)){if(typeof fetch=="function"&&!J(d))return fetch(d,{credentials:"same-origin"}).then(function(n){if(!n.ok)throw"failed to load wasm binary file at '"+d+"'";return n.arrayBuffer()}).catch(function(){return Q(d)});if(P)return new Promise(function(n,t){P(d,function(r){n(new Uint8Array(r))},t)})}return Promise.resolve().then(function(){return Q(d)})}function Ae(){var n={a:Ie};function t(i,a){var y=i.exports;e.asm=y,W=e.asm.c,le(W.buffer),e.asm.l,ye(e.asm.d),we()}Re();function r(i){t(i.instance)}function o(i){return be().then(function(a){return WebAssembly.instantiate(a,n)}).then(function(a){return a}).then(i,function(a){T("failed to asynchronously prepare wasm: "+a),O(a)})}function l(){return!S&&typeof WebAssembly.instantiateStreaming=="function"&&!$(d)&&!J(d)&&!M&&typeof fetch=="function"?fetch(d,{credentials:"same-origin"}).then(function(i){var a=WebAssembly.instantiateStreaming(i,n);return a.then(r,function(y){return T("wasm streaming compile failed: "+y),T("falling back to ArrayBuffer instantiation"),o(r)})}):o(r)}if(e.instantiateWasm)try{var u=e.instantiateWasm(n,t);return u}catch(i){T("Module.instantiateWasm callback failed with error: "+i),s(i)}return l().catch(s),{}}function Ee(n){this.name="ExitStatus",this.message="Program terminated with exit("+n+")",this.status=n}function L(n){for(;n.length>0;)n.shift()(e)}function Be(n,t){q.set(n,t)}function Te(n,t,r){D.copyWithin(n,t,t+r)}function Se(n){O("OOM")}function De(n){D.length,Se()}function Z(n){var t=e["_"+n];return t}function Ue(n,t,r,o,l){var u={string:m=>{var B=0;if(m!=null&&m!==0){var re=(m.length<<2)+1;B=C(re),de(m,B,re)}return B},array:m=>{var B=C(m.length);return Be(m,B),B}};function i(m){return t==="string"?ue(m):t==="boolean"?Boolean(m):m}var a=Z(n),y=[],A=0;if(o)for(var E=0;E<o.length;E++){var te=u[r[E]];te?(A===0&&(A=x()),y[E]=te(o[E])):y[E]=o[E]}var N=a.apply(null,y);function Ge(m){return A!==0&&ee(A),i(m)}return N=Ge(N),N}function Pe(n,t,r,o){r=r||[];var l=r.every(i=>i==="number"||i==="boolean"),u=t!=="string";return u&&l&&!o?Z(n):function(){return Ue(n,t,r,arguments)}}var Ie={b:Te,a:De};Ae(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.d).apply(null,arguments)},e._call_load_wrapper=function(){return(e._call_load_wrapper=e.asm.e).apply(null,arguments)},e._create_buffer=function(){return(e._create_buffer=e.asm.f).apply(null,arguments)},e._destroy_buffer=function(){return(e._destroy_buffer=e.asm.g).apply(null,arguments)},e._get_pointer=function(){return(e._get_pointer=e.asm.h).apply(null,arguments)},e._get_size=function(){return(e._get_size=e.asm.i).apply(null,arguments)},e._get_width=function(){return(e._get_width=e.asm.j).apply(null,arguments)},e._get_height=function(){return(e._get_height=e.asm.k).apply(null,arguments)};var x=e.stackSave=function(){return(x=e.stackSave=e.asm.m).apply(null,arguments)},ee=e.stackRestore=function(){return(ee=e.stackRestore=e.asm.n).apply(null,arguments)},C=e.stackAlloc=function(){return(C=e.stackAlloc=e.asm.o).apply(null,arguments)};e.cwrap=Pe;var X;U=function n(){X||ne(),X||(U=n)};function ne(n){if(b>0||(me(),b>0))return;function t(){X||(X=!0,e.calledRun=!0,!j&&(pe(),p(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),_e()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),t()},1)):t()}if(e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return ne(),e.ready}})();let v,R;const Xe=new Promise(g=>{Oe().then(async f=>{R=f,v={alloc:R.cwrap("create_buffer","number",["number"]),load:R.cwrap("call_load_wrapper","",["array","number"]),get_pointer:R.cwrap("get_pointer","number",[]),get_size:R.cwrap("get_size","number",[]),get_width:R.cwrap("get_width","number",[]),get_height:R.cwrap("get_height","number",[]),clean:R.cwrap("destroy_buffer","",["number"])},g()})});async function se(g,f="url"){let e=await fetch(g);e=await e.arrayBuffer(),e=new Uint8Array(e);const p=v.alloc(e.length);R.HEAPU8.set(e,p),v.load(p,e.length);const s=new Uint8Array(R.HEAPU8.buffer,v.get_pointer(),v.get_size()),c=await Me(s,v.get_width(),v.get_height(),v.get_size());return v.clean(p),v.clean(v.get_pointer()),f==="url"?URL.createObjectURL(c):c}async function Me(g,f,e,p){if(!f)return!1;const s=document.createElement("canvas");s.width=f,s.height=e;const c=s.getContext("2d"),w=new ImageData(new Uint8ClampedArray(g.slice(0,p)),f,e);return c.drawImage(await createImageBitmap(w,{imageOrientation:"flipY"}),0,0),new Promise((h,M)=>s.toBlob(h))}let ie=!1;const ke=document.getElementById("demo");function Fe(){if(ie)return;ie=!0;const g="https://raw.githubusercontent.com/npedotnet/DDSReader/master/images/";`dds_A1R5G5B5_mipmap.dds
dds_A1R5G5B5.dds
dds_A4R4G4B4.dds
dds_A4R4G4B4_mipmap.dds
dds_A8B8G8R8.dds
dds_A8B8G8R8_mipmap.dds
dds_A8R8G8B8.dds
dds_A8R8G8B8_mipmap.dds
dds_DXT1.dds
dds_DXT1_mipmap.dds
dds_DXT2.dds
dds_DXT2_mipmap.dds
dds_DXT3.dds
dds_DXT3_mipmap.dds
dds_DXT4.dds
dds_DXT4_mipmap.dds
dds_DXT5.dds
dds_DXT5_mipmap.dds
dds_R5G6B5.dds
dds_R5G6B5_mipmap.dds
dds_R8G8B8.dds
dds_R8G8B8_mipmap.dds
dds_X1R5G5B5.dds
dds_X1R5G5B5_mipmap.dds
dds_X4R4G4B4.dds
dds_X4R4G4B4_mipmap.dds
dds_X8B8G8R8.dds
dds_X8B8G8R8_mipmap.dds
dds_X8R8G8B8.dds
dds_X8R8G8B8_mipmap.dds`.split(`
`).forEach(f=>{ke.innerHTML+=`<img class="dds-image" source="${g}${f}">`}),Xe.then(async()=>{const f=Array.from(document.getElementsByClassName("dds-image"));for(const e of f)try{e.src=await se(e.getAttribute("source"))}catch(p){e.classList="unsupported-format",console.log(p)}})}document.getElementById("start").onclick=Fe;const ae=document.getElementById("selector"),Le=document.getElementById("preview");ae.addEventListener("change",async g=>{Le.src=await se(URL.createObjectURL(ae.files[0]))});
